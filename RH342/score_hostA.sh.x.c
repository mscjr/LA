#if 0
	shc Version 4.0.1, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f score_hostA.sh -o score_host_A 
#endif

static  char data [] = 
#define      opts_z	1
#define      opts	((&data[0]))
	"\335"
#define      msg2_z	19
#define      msg2	((&data[5]))
	"\226\007\047\126\263\003\340\350\121\137\041\364\117\123\164\272"
	"\217\221\132\027\210\042\146\356"
#define      chk2_z	19
#define      chk2	((&data[29]))
	"\237\047\333\161\373\130\263\271\140\016\333\321\262\067\022\317"
	"\252\101\035\033\104\112\117\056\121\140\121"
#define      chk1_z	22
#define      chk1	((&data[52]))
	"\236\374\003\373\117\120\253\227\224\074\135\025\024\305\177\310"
	"\267\100\033\306\303\331"
#define      text_z	2850
#define      text	((&data[616]))
	"\352\170\057\336\116\331\261\301\031\366\326\001\276\346\267\210"
	"\051\374\246\101\225\367\200\243\023\334\322\303\222\077\227\124"
	"\056\211\143\345\233\312\340\102\062\070\173\233\256\241\301\045"
	"\200\020\146\171\176\256\376\162\000\152\027\075\124\244\115\122"
	"\146\323\226\345\000\332\122\315\012\364\332\317\001\202\250\115"
	"\017\363\057\330\012\165\240\066\305\364\143\103\325\263\252\203"
	"\047\375\305\021\045\034\355\065\127\201\167\322\034\253\205\101"
	"\074\254\071\010\000\110\355\323\131\224\217\122\371\152\362\047"
	"\103\137\242\240\103\373\256\240\314\266\171\201\176\247\354\253"
	"\077\334\041\331\245\237\370\034\120\221\022\121\365\266\100\362"
	"\340\036\277\175\246\213\355\056\336\145\040\250\267\263\042\307"
	"\341\352\151\151\102\055\171\277\347\061\225\177\047\036\133\262"
	"\164\247\234\125\226\211\257\340\242\130\040\321\304\145\377\004"
	"\254\230\350\024\336\304\270\130\356\014\260\011\232\304\147\355"
	"\211\330\160\256\210\147\111\321\306\013\301\102\262\105\110\117"
	"\254\370\246\022\341\222\231\160\105\176\144\050\106\051\316\305"
	"\340\355\130\162\033\144\360\266\153\023\034\345\336\016\206\336"
	"\316\356\231\225\205\174\125\061\010\024\175\202\016\314\112\111"
	"\177\314\210\006\210\363\220\067\235\174\105\160\302\341\271\313"
	"\173\162\145\234\211\123\354\342\116\071\250\375\003\204\372\074"
	"\246\273\204\266\333\006\211\001\223\357\134\050\106\215\103\203"
	"\372\371\300\336\302\110\151\216\103\234\224\220\032\014\360\146"
	"\215\057\277\334\153\214\125\307\221\036\363\203\055\356\264\057"
	"\073\106\301\171\150\076\257\331\021\270\220\232\106\047\177\015"
	"\365\015\266\137\354\130\002\047\223\156\273\223\334\123\157\232"
	"\010\000\175\026\300\341\076\120\346\072\337\232\123\055\215\017"
	"\021\257\152\016\145\374\356\275\004\176\047\300\077\054\132\216"
	"\042\256\333\021\013\132\362\012\365\045\120\116\274\256\313\376"
	"\245\013\234\305\266\022\175\025\352\330\166\156\026\250\326\234"
	"\173\373\026\067\112\127\040\147\220\362\057\267\272\157\152\363"
	"\334\355\251\053\204\003\217\356\331\314\221\230\355\032\260\044"
	"\263\265\057\312\107\363\242\125\271\366\316\076\061\215\226\224"
	"\031\361\040\275\317\231\170\201\307\006\314\335\267\175\273\263"
	"\020\230\135\240\202\035\276\155\270\044\237\334\217\003\301\336"
	"\044\231\016\073\053\231\055\212\034\124\326\067\013\274\107\126"
	"\323\302\173\171\236\040\200\232\006\165\066\224\252\162\236\122"
	"\275\006\341\111\246\021\171\367\006\272\212\337\113\227\057\052"
	"\364\323\321\230\177\316\141\351\213\226\141\246\370\320\127\214"
	"\342\317\117\140\041\311\211\275\232\003\311\302\110\264\060\361"
	"\067\176\101\276\053\025\115\025\360\332\211\265\370\335\262\025"
	"\076\174\161\375\111\324\341\106\356\315\360\041\164\153\173\024"
	"\066\264\024\337\237\177\125\325\011\173\155\251\024\343\366\155"
	"\316\353\270\334\123\373\041\356\154\054\006\052\115\110\237\001"
	"\043\331\030\217\316\052\161\201\122\265\233\303\101\237\145\131"
	"\304\166\271\375\133\120\265\363\176\155\302\075\032\052\007\136"
	"\305\162\132\363\026\016\131\015\035\361\073\360\215\261\347\047"
	"\317\020\330\152\143\061\272\012\145\002\117\012\121\060\273\375"
	"\046\265\242\226\276\106\263\250\137\306\362\363\215\133\221\157"
	"\014\117\226\262\056\245\237\260\240\075\072\203\053\014\242\375"
	"\325\335\031\142\361\015\166\260\333\041\122\120\116\173\162\261"
	"\231\132\253\350\212\312\063\221\107\334\376\033\026\022\350\045"
	"\236\327\312\010\256\356\315\133\060\206\246\054\103\006\070\311"
	"\117\127\152\132\225\300\032\305\172\222\253\166\270\065\164\341"
	"\333\215\274\302\173\353\102\120\317\036\140\061\265\212\367\346"
	"\007\307\347\254\317\323\302\342\332\376\204\344\162\144\041\145"
	"\370\265\316\227\101\277\313\142\076\271\275\300\043\265\077\022"
	"\001\161\265\171\213\000\072\306\066\321\002\227\123\320\147\244"
	"\254\232\330\232\202\235\267\153\060\105\224\232\320\022\313\110"
	"\326\052\306\126\117\254\361\202\015\006\373\147\154\332\123\375"
	"\042\104\374\110\365\332\010\134\067\214\242\020\043\117\342\074"
	"\127\324\371\340\305\143\132\167\364\171\263\060\121\200\014\370"
	"\152\206\377\120\106\014\005\331\252\237\331\367\334\302\375\304"
	"\236\011\350\367\172\341\273\141\141\237\377\070\207\265\235\063"
	"\177\200\075\350\327\324\357\313\363\035\242\347\261\262\074\165"
	"\015\214\076\045\272\177\361\205\172\363\341\045\260\335\330\305"
	"\073\363\122\300\203\235\371\270\234\035\167\375\321\264\265\010"
	"\132\226\346\367\273\350\075\375\021\265\001\135\333\144\177\034"
	"\276\367\361\060\066\250\005\235\166\354\247\056\020\013\050\140"
	"\037\364\227\100\364\063\153\265\212\171\244\351\273\262\145\161"
	"\301\243\227\021\276\061\046\110\142\164\134\307\065\056\327\007"
	"\277\212\021\235\344\254\246\352\240\201\202\063\235\202\246\220"
	"\066\075\163\160\353\033\016\233\116\150\177\217\022\101\347\153"
	"\370\052\132\360\066\340\070\202\061\161\364\063\166\375\157\131"
	"\057\015\233\076\104\010\175\355\132\340\212\104\210\231\237\235"
	"\316\202\021\310\202\013\022\131\031\210\106\056\154\140\015\372"
	"\323\355\370\166\076\207\152\243\354\302\063\160\251\133\264\125"
	"\215\217\320\000\237\375\316\304\171\221\011\144\002\226\041\377"
	"\165\054\357\112\065\254\114\175\371\172\132\331\100\166\272\211"
	"\075\204\104\151\000\370\343\337\316\375\040\365\270\374\024\255"
	"\013\227\227\106\117\027\340\272\210\367\103\060\120\213\016\064"
	"\255\200\202\053\111\341\024\101\026\325\037\224\013\251\247\153"
	"\172\331\346\121\227\067\220\370\043\306\101\043\137\134\075\021"
	"\060\355\230\254\033\212\175\374\170\066\026\215\053\243\375\103"
	"\353\321\277\131\321\310\041\121\133\307\140\360\131\207\030\067"
	"\210\314\076\005\156\154\054\020\240\132\240\371\332\200\122\371"
	"\126\156\253\025\000\253\067\106\203\003\312\257\022\153\260\064"
	"\057\367\315\275\257\103\262\377\365\240\120\060\030\105\005\051"
	"\176\024\167\027\225\002\174\220\316\305\157\122\262\310\074\240"
	"\267\301\336\207\236\041\135\131\164\175\116\173\354\273\342\176"
	"\075\114\056\353\227\161\347\073\365\357\175\053\034\033\001\344"
	"\232\253\057\341\222\220\306\076\326\242\041\366\177\014\240\045"
	"\040\001\304\147\053\042\112\235\353\065\323\200\162\044\251\112"
	"\245\134\052\106\273\130\000\333\226\236\074\167\231\023\074\136"
	"\354\153\033\035\247\276\074\275\123\126\104\051\266\330\264\177"
	"\231\345\221\055\063\016\034\135\271\243\032\113\151\217\255\177"
	"\275\207\020\167\323\151\064\134\162\304\104\374\357\152\044\166"
	"\173\146\171\166\125\237\377\265\232\214\251\322\126\060\224\155"
	"\317\054\307\233\055\312\255\067\240\252\050\223\057\323\136\072"
	"\304\335\301\126\045\115\333\212\351\076\067\151\237\041\177\120"
	"\005\254\331\321\324\317\131\110\012\302\052\234\252\307\121\174"
	"\056\327\016\002\243\063\117\215\315\176\067\335\311\034\263\345"
	"\066\031\130\135\153\262\124\307\310\352\312\025\015\264\313\010"
	"\364\051\245\167\052\204\055\342\024\374\066\012\043\200\337\142"
	"\316\200\031\074\104\215\036\024\376\011\022\171\117\141\317\064"
	"\125\276\122\133\272\013\042\104\251\161\170\255\266\351\070\061"
	"\367\175\011\154\130\361\266\036\113\013\330\240\305\040\036\242"
	"\033\314\143\151\220\103\115\260\005\367\335\122\350\070\200\173"
	"\310\116\225\320\322\202\120\222\000\075\127\244\325\120\040\367"
	"\260\134\363\066\014\306\132\070\024\125\123\013\345\001\024\153"
	"\113\266\156\270\131\262\203\023\175\032\002\240\277\070\223\115"
	"\041\147\074\007\270\330\105\004\370\300\271\125\323\247\143\204"
	"\335\375\066\112\007\365\240\260\033\353\374\264\305\060\020\125"
	"\034\024\001\176\204\161\332\251\314\316\110\124\313\026\047\342"
	"\113\031\323\071\123\033\203\173\023\261\342\316\007\116\024\056"
	"\001\072\241\311\227\347\046\106\023\232\122\152\151\053\160\052"
	"\125\006\373\031\166\045\131\354\164\276\375\053\173\345\315\352"
	"\163\177\227\363\035\043\105\173\123\146\337\043\042\051\353\056"
	"\367\012\070\373\073\007\356\066\124\153\206\114\341\366\154\246"
	"\205\074\141\243\345\154\322\374\372\164\376\070\214\236\342\216"
	"\135\261\072\143\077\334\274\054\063\057\137\253\114\210\061\023"
	"\173\270\254\043\050\037\160\160\343\013\354\345\300\340\150\351"
	"\270\336\054\070\331\212\004\355\356\136\217\322\351\304\257\137"
	"\314\204\331\331\076\045\030\117\112\360\064\302\150\351\275\375"
	"\303\041\064\352\135\363\314\334\214\214\045\231\236\245\220\160"
	"\025\075\144\361\141\245\242\315\061\144\220\345\311\174\312\355"
	"\071\264\304\060\002\362\375\367\376\163\114\333\173\276\342\252"
	"\366\106\323\151\273\024\241\221\132\113\306\120\337\161\122\135"
	"\131\247\270\342\230\055\141\010\023\335\355\021\045\046\035\376"
	"\042\317\024\032\221\247\307\063\120\320\326\336\023\202\005\136"
	"\234\164\173\240\233\121\045\124\125\134\372\360\326\011\106\334"
	"\015\103\347\104\105\050\175\356\035\320\052\306\113\054\003\076"
	"\046\156\177\036\014\262\301\161\253\254\103\374\366\370\012\214"
	"\140\365\065\147\170\207\064\267\225\332\224\370\210\351\141\117"
	"\350\372\154\154\115\144\272\376\232\003\347\006\044\015\027\121"
	"\363\241\040\206\212\143\252\347\040\173\133\270\242\101\116\165"
	"\106\233\201\100\343\061\305\120\045\175\241\157\227\071\160\206"
	"\266\326\260\107\263\264\112\014\055\330\140\145\004\022\137\324"
	"\056\277\107\350\222\115\136\166\250\212\352\206\364\001\113\260"
	"\260\105\301\063\104\037\147\230\120\035\025\121\024\036\101\245"
	"\361\230\163\141\131\150\102\367\073\176\203\173\234\175\062\255"
	"\374\113\373\235\030\313\125\011\332\341\271\354\334\145\243\143"
	"\206\062\260\357\176\346\027\164\336\141\340\067\216\165\060\230"
	"\247\144\351\060\051\370\130\001\016\306\234\351\056\307\007\147"
	"\030\107\112\037\221\015\225\336\203\314\376\172\151\262\237\137"
	"\036\360\114\200\036\314\311\331\314\054\371\102\362\160\302\044"
	"\375\241\004\074\027\116\317\147\053\005\362\102\101\070\033\221"
	"\222\201\327\114\353\351\161\332\333\301\103\316\100\226\301\244"
	"\104\314\022\354\165\152\327\271\366\147\140\340\365\273\171\236"
	"\136\034\125\313\143\115\345\352\014\056\014\137\211\347\256\036"
	"\004\230\122\351\105\245\044\315\154\266\363\261\142\113\370\032"
	"\326\353\133\374\127\136\375\233\171\335\324\004\356\056\310\274"
	"\341\061\177\364\317\101\002\042\144\262\264\220\001\175\243\176"
	"\140\260\111\144\020\120\017\243\350\333\070\021\064\007\223\247"
	"\212\100\046\220\234\071\112\043\075\076\363\141\022\062\211\351"
	"\012\266\111\024\012\312\306\076\220\166\305\074\012\033\201\333"
	"\052\007\043\300\267\013\056\122\334\314\037\006\135\100\200\254"
	"\306\045\026\033\210\107\106\334\273\067\237\144\115\114\152\320"
	"\336\024\204\175\360\103\121\113\364\353\326\050\334\335\053\276"
	"\247\243\247\344\040\211\224\115\123\274\275\251\222\141\330\345"
	"\303\277\050\147\111\230\122\322\310\104\233\002\015\254\141\050"
	"\043\350\272\301\003\207\317\240\035\322\125\127\103\172\212\305"
	"\262\344\261\141\225\117\001\046\213\014\105\210\122\236\072\020"
	"\361\074\143\377\307\113\031\326\160\121\240\153\136\153\310\036"
	"\207\156\026\063\103\155\010\312\277\302\313\225\342\202\335\220"
	"\065\130\175\256\001\123\100\240\235\125\010\263\130\103\054\143"
	"\355\345\320\053\356\277\277\372\307\376\215\361\071\006\326\016"
	"\030\266\203\212\276\173\264\240\230\150\267\071\236\102\257\246"
	"\302\132\110\231\302\164\115\301\257\141\016\075\112\176\317\071"
	"\070\026\152\017\373\170\373\215\027\103\062\154\240\110\332\114"
	"\141\257\363\142\355\316\344\045\131\107\276\003\300\316\271\003"
	"\005\124\243\170\270\346\206\064\322\073\243\265\204\163\326\246"
	"\104\104\047\162\130\020\350\271\055\216\355\306\030\344\352\330"
	"\360\366\107\010\166\346\143\371\241\222\134\053\234\350\144\241"
	"\075\367\335\114\204\045\335\101\260\343\100\257\346\027\370\016"
	"\332\131\227\045\350\235\121\124\027\107\022\344\000\222\320\344"
	"\234\343\336\251\061\245\050\161\123\373\303\172\201\060\301\205"
	"\011\345\252\062\161\130\233\127\315\045\021\073\173\163\274\107"
	"\212\367\324\335\144\132\070\041\325\115\210\066\034\214\220\020"
	"\073\107\150\112\334\046\142\036\162\320\147\345\152\076\336\141"
	"\122\163\047\135\342\066\230\162\272\033\225\014\121\347\274\016"
	"\331\351\153\020\221\267\362\345\204\252\110\143\345\162\326\217"
	"\134\242\340\143\054\145\277\263\371\175\217\250\071\214\220\330"
	"\223\165\276\111\237\063\330\262\025\005\104\237\017\027\072\313"
	"\212\335\120\135\172\074\231\036\333\103\371\272\167\121\136\232"
	"\114\040\007\053\140\205\333\121\237\061\262\161\346\042\300\017"
	"\271\225\215\203\307\061\354\244\176\176\342\153\110\364\106\112"
	"\032\137\014\352\173\234\165\032\154\246\331\054\004\320\112\302"
	"\332\007\312\300\002\317\173\154\164\171\171\167\105\210\022\013"
	"\345\210\370\265\326\226\266\373\304\053\207\064\203\135\042\160"
	"\313\165\156\141\217\067\357\057\131\255\364\034\112\163\101\236"
	"\344\116\370\121\102\142\333\001\324\326\052\034\324\077\340\134"
	"\360\333\333\074\254\376\324\232\207\367\147\023\306\110\050\273"
	"\104\325\106\263\041\166\275\246\046\113\257\060\174\063\362\234"
	"\203\074\101\177\254\147\045\132\317\335\216\243\320\036\115\063"
	"\010\320\344\320\243\215\063\011\250\305\245\124\107\217\256\371"
	"\066\034\302\103\335\273\351\161\015\320\353\344\261\014\342\117"
	"\071\233\024\047\317\277\115\065\135\266\113\063\227\325\273\165"
	"\071\237\223\122\125\027\272\162\367\322\350\077\041\021\125\016"
	"\006\052\060\331\031\132\221\316\103\367\262\274\104\031\162\311"
	"\056\247\217\145\014\030\354\246\063\311\103\131\033\363\177\374"
	"\153\067\362\367\056\120\336\227\272\055\173\026\342\361\016\320"
	"\210\360\035\225\316\251\365\205\124\116\006\226\300\005\066\332"
	"\017\367\030\204\105\117\353\372\207\344\166\223\136\016\074\242"
	"\377\002\300\252\375\351\133\216\245\367\314\351\120\112\240\012"
	"\327\237\073\341\151\012\341\335\236\234\113\221\017\311\337\111"
	"\207\045\275\351\264\265\217\263\364\334\270\376\255\034\253\164"
	"\132\344\163\277\272\043\263\142\334\247\124\072\022\364\342\152"
	"\154\114\070\130\007\337\313\313\336\232\154\071\156\213\136\213"
	"\226\216\134\266\324\253\166\344\226\046\077\164\007\173\130\006"
	"\157\026\062\234\130\175\157\115\057\044\231\155\265\321\212\142"
	"\270\210\016\074\340\360\213\031\270\122\343\154\177\161\151\041"
	"\117\132\175\340\136\250\144\256\055\347\066\236\313\225\037\366"
	"\117\022\336\355\100\136\101\103\152\113\041\234\312\126\324\063"
	"\236\321\026\046\067\363\077\047\366\332\141\360\330\311\103\156"
	"\331\316\012\305\051\243\341\230\305\315\343\063\346\151\002\043"
	"\014\127\063\363\275\046\376\362\022\010\226\130\224\064\337\311"
	"\162\104\322\356\205\301\327\011\313\156\265\352\053\276\147\010"
	"\037\357\145\351\200\371\021\376\077\343\030\026\240\123\170\235"
	"\174\304\233\122\346\363\302\354\033\015\052\013\257\206\154\040"
	"\064\102\356\015\202\021\061\000\366\240\342\045\114\316\326\376"
	"\350\363\247\044\152\121\365\003\301\327\206\134\327\114\313\375"
	"\162\121\225\273\340\206\303\372\064\070\156\163\234\115\050\206"
	"\045\316\123\213\174\355\046\122\234\362\274\356\157\321\373\351"
#define      rlax_z	1
#define      rlax	((&data[3642]))
	"\163"
#define      tst2_z	19
#define      tst2	((&data[3645]))
	"\334\131\211\115\264\173\076\236\135\342\240\233\314\146\362\140"
	"\051\070\261\014\045\067"
#define      pswd_z	256
#define      pswd	((&data[3707]))
	"\065\251\002\252\274\161\056\114\330\110\225\155\374\227\077\317"
	"\056\310\243\064\063\071\116\256\274\135\277\206\136\116\006\140"
	"\204\167\320\250\061\142\111\313\324\363\030\025\343\230\047\320"
	"\217\007\203\102\042\141\134\210\240\167\110\347\021\144\235\036"
	"\267\367\013\376\077\157\112\126\117\006\205\075\200\176\240\141"
	"\040\105\306\301\167\037\102\106\256\363\217\364\362\062\360\037"
	"\352\112\345\003\031\355\224\074\152\047\265\113\016\106\073\172"
	"\171\337\164\262\064\165\320\110\165\270\050\230\376\201\240\000"
	"\262\373\272\026\326\141\255\217\117\107\051\251\362\311\324\125"
	"\341\012\063\007\116\021\260\310\127\026\225\256\334\341\143\122"
	"\205\207\202\052\101\324\353\345\303\105\324\132\000\133\000\323"
	"\376\263\220\050\322\145\102\230\345\363\041\110\356\335\226\232"
	"\244\374\151\016\305\300\104\225\163\026\053\154\311\114\010\263"
	"\263\010\312\013\143\354\021\033\227\220\067\257\050\306\344\321"
	"\016\211\100\323\256\042\263\063\171\125\351\226\352\126\072\245"
	"\050\037\103\275\272\207\052\326\122\345\311\237\374\023\056\040"
	"\077\226\311\236\027\270\271\107\103\240\245\377\357\000\311\165"
	"\350\263\013\230\160\043\043\350\162\225\222\101\031\005\325\360"
	"\045\123\001\156\242\151\135\334\030\350\253\174\160\027\351\124"
	"\160\141\275\200\244\011\227\161\145\336\266\161\321"
#define      date_z	1
#define      date	((&data[3982]))
	"\266"
#define      tst1_z	22
#define      tst1	((&data[3986]))
	"\272\040\013\157\331\231\324\104\323\061\060\367\306\055\155\077"
	"\141\366\162\156\317\122\155\325\052\137\122\155"
#define      inlo_z	3
#define      inlo	((&data[4011]))
	"\305\141\336"
#define      msg1_z	65
#define      msg1	((&data[4030]))
	"\252\202\041\210\110\231\263\106\224\372\346\052\126\305\026\367"
	"\306\174\231\017\053\314\144\030\165\213\377\130\321\051\106\227"
	"\366\107\240\342\304\377\265\175\373\116\247\345\324\170\173\300"
	"\304\145\211\063\377\066\327\053\323\040\116\233\240\354\135\047"
	"\355\327\157\124\104\120\216\260\102\070\144\100\342\311\043\210"
	"\022\240\257\016\212\302\262\332"
#define      shll_z	10
#define      shll	((&data[4102]))
	"\005\027\264\223\332\053\001\372\020\010"
#define      lsto_z	1
#define      lsto	((&data[4112]))
	"\036"
#define      xecc_z	15
#define      xecc	((&data[4114]))
	"\033\106\344\224\176\311\263\261\005\277\017\325\064\026\202\247"
	"\127"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define HARDENINGSP	0	/* Define as 1 to disable bash child process */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a processs */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;

    int lentmp = len;

#if HARDENINGSP
    //Start tracing to protect from dump & trace
    if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }

    //Decode Bash
    while (len > 0) {
        indx++;
        tmp = stte[indx];
        jndx += tmp;
        stte[indx] = stte[jndx];
        stte[jndx] = tmp;
        tmp += stte[indx];
        *ptr ^= stte[tmp];
        ptr++;
        len--;
    }

    //Exec bash script
    system(tmp2);

    //Empty script variable
    memcpy(tmp2, str, lentmp);

    //Sinal to detach ptrace
    ptrace(PTRACE_DETACH, 0, 0, 0);
    exit(0);

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
#endif /* HARDENINGSP Exit here anyway*/

    int pid, status;
    pid = fork();

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            printf("Operation not permitted\n");
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Exec bash script
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {
        wait(&status);
    }

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
} 
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
